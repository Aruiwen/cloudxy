#summary 段清理语意实现

= 段清理说明 =
目的：回收冗余数据，释放磁盘空间
支持：
 * 两步实现段清理——段统计和段回收
 * 快照条件下的段清理
 * 在线和离线条件下段清理
 * 拉模式和推模式段统计计数
= 回收步骤 =
 # 首先计算给定段的段统计计数 —— 用于段回收阶段
{{{
拉模式执行段统计：output/bin/segcalc.hlfs -u local:///tmp/testenv/testfs -s 0 -e 100  ; 具体命令参数请 -h 查看

推模式执行段统计（只能在hdfs之上）：hadoop pipes -D mapred.reduce.tasks=1 -input /tmp/testenv/testfs  -output /output -program /exe/mr_segcalc.hlfs；
* mr_segcalc.hlfs 通过/src/clean/Mapreducer/下编译而得
}}}
 # 其次进行段回收 —— 段统计之后才可回收
{{{
离线模式（当hlfs close后才能是使用): ../../../output/bin/segclean.hlfs -u local:///tmp/testenv/testfs -s 0 -e 100   ; 具体命令参数请 -h 查看
在线模式（runtime) : 不需要外部触发，由seg_clean_task后台任务周期执行。
}}}

-- 由于测试不很充分，因此难免有一些bug,欢迎指正